---
title: "mtcars"
output: html_document
---

# Correspondence Analysis

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(e1071)
library(FactoMineR)
library(factoextra)
library(gplots)
data("mtcars")
?mtcars
mtcars
str(mtcars)
```

##  Normalazing dataset

```{r}
normalize <- function(x){
  return((x-min(x))/(max(x)-min(x)))    
}

mtcars$mpg <- normalize(mtcars$mpg)
mtcars$cyl <- normalize(mtcars$cyl)
mtcars$disp <- normalize(mtcars$disp)
mtcars$hp <- normalize(mtcars$hp)
mtcars$drat <- normalize(mtcars$drat)
mtcars$wt <- normalize(mtcars$wt)
mtcars$qsec <- normalize(mtcars$qsec)
mtcars$vs <- normalize(mtcars$vs)
mtcars$am <- normalize(mtcars$am)
mtcars$gear <- normalize(mtcars$gear)
mtcars$carb <- normalize(mtcars$carb)

mtcars
```

## Conversion to table

```{r}
dt <- as.table(as.matrix(mtcars))   
```


## Graph of contingency table
### Size of balloon means numeber of occurences - similar sizes of balloons in case of mtcars

```{r}
balloonplot(t(dt), main = "mtcars", xlab="", ylab="", 
            label = TRUE, show.margins = FALSE)
```


## CA results
### The row variable has  32  categories; the column variable has 11 categories
### The chi square of independence between the two variables is equal to 91.80067 (p-value =  1 )

```{r}
ca_result <- CA(dt, graph =FALSE)
print(ca_result) 
```



## Eigenvalue correlation explanation
### Two first dimensions explain 87% (cumulative variance percent), typical boundary: 80% cumulative variance
### correlation explanation plotted 

```{r}
eig.val <- get_eigenvalue(ca_result) 
eig.val 
fviz_screeplot(ca_result, addlabels = TRUE, ylim = c(0,50))
```



## Contribution to  dim1: Honda Civic the highest contribution to Dim-1
### Many cars share similar contribution # the highest influence if point goes left or right
## Contribution to  dim2: Masarati Bora the highest contributuon to Dim-2
### Many cars share similar contributuion # the highest influence if point goes up or down
## Symmetric plot
### Points with similar profile are closer on the factor map

```{r}
fviz_contrib(ca_result, choice = "row", axes = 1, top = 10)
fviz_contrib(ca_result, choice = "row", axes = 2, top = 10) 
fviz_ca_biplot(ca_result, col.row = "contrib", repel = TRUE) 
```

